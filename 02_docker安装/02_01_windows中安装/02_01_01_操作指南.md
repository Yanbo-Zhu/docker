
# 1 Virtualization enable

Docker Engine 需要 Linux funktionen, die durch Linux Kernel 实现 
Mit wsl2 kann man bekannten Linux distributioen auswahlen und direkt aus der Linux Umgebung , die  Docker engine nuzten

使用 wsl 可以 das Windows-Subsystem für Linux zu installieren
Docker desktop bringt aber weiterhin die integration mit, um auch aus der windows umgebung  Docker zu verwenden 

![](image/Pasted%20image%2020240207152533.png)

![](image/Pasted%20image%2020240207152538.png)

![](image/Pasted%20image%2020240207152543.png)


https://docs.docker.com/desktop/windows/troubleshoot/#virtualization


## 1.1 运行 Docker  必须 enable 的 windows Feature 

1 如果你想要 docker 用的是 hyper-v backend 或者 windows container 

[https://docs.docker.com/desktop/install/windows-install/#hyper-v-backend-and-windows-containers](https://docs.docker.com/desktop/install/windows-install/#hyper-v-backend-and-windows-containers)
Hyper-V and Containers Windows features must be enabled.

![](image/Pasted%20image%2020240207152628.png)

![](image/Pasted%20image%2020240207152633.png)


如果你想要 docker 用的是  wsl2 backend

• Enable the WSL 2 feature on Windows. For detailed instructions, refer to the Microsoft documentation.

![](image/Pasted%20image%2020240207152649.png)


![](image/Pasted%20image%2020240207152654.png)


# 2 安装 Docker Desktop on Windows

|   |   |
|---|---|
|1下载安装包| |
|2|When prompted, ensure the Use WSL 2 instead of Hyper-V option on the Configuration page is selected or not depending on your choice of backend.<br><br>If your system only supports one of the two options, you will not be able to select which backend to use.<br><br>![](image/Pasted%20image%2020240207152802.png)<br> |
|3|Follow the instructions on the installation wizard to authorize the installer and proceed with the install.<br><br>When the installation is successful, click Close to complete the installation process.|
|4|这一步我还没做 onbws18067 am 2023.02.16<br><br>1 通过 手动<br><br>If your admin account is different to your user account, you must add the user to the docker-users group. Run Computer Management as an administrator and navigate to Local Users and Groups > Groups > docker-users. Right-click to add the user to the group. Log out and log back in for the changes to take effect.<br><br>2 通过命令<br><br>If your admin account is different to your user account, you must add the user to the docker-users group:<br><br> net localgroup docker-users <user> /add|

## 2.1 Docker Desktop on Windows 的设置

Docker Engine 

![](image/Pasted%20image%2020240207152856.png)

```
原来为 
{
  "builder": {
    "gc": {
      "defaultKeepStorage": "20GB",
      "enabled": true
    }
  },
  "experimental": false,
  "features": {
    "buildkit": true
  }
}


我自己改为 
{
  "builder": {
    "gc": {
      "defaultKeepStorage": "20GB",
      "enabled": true
    }
  },
  "default-address-pools": [
    {
      "base": "10.232.64.0/18",
      "size": 24
    }
  ],
  "experimental": false,
  "features": {
    "buildkit": true
  },
  "registry-mirrors": [
    "https://dockerhub.nexus3.ivu.de"
  ]
}

```

2 Enable kubernates 

![](image/Pasted%20image%2020240207152909.png)



## 2.2 测试是否安装成功

a.	Open the Command prompt
b.	Type docker run hello-world and press enter
c.	You should eventually see a welcome message from Docker


🦄  docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
2db29710123e: Pull complete
Digest: sha256:6e8b6f026e0b9c419ea0fd02d3905dd0952ad1feea67543f525c73a0a790fefb
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/


# 3 如何设置 使得在 wsl 中使用 docker 

## 3.1 安装新的 linux distribution

(用 docker 运行，ahnlich wie 新安装一个 linux 虚拟机 ， 运行 linux betreibsystem )
目的： 为了使得使用者 在  linux welt 下， 也可以使用 docker engine， 我们就自己装一个 Linux OS 在 本机中
eine Linux-Verteilung installiert und eingerichtet, die vollständig in Ihr Windows-Betriebssystem integriert ist. （这就是 wsl2 的作用 ）
[https://docs.microsoft.com/de-de/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package](https://docs.microsoft.com/de-de/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package)

1 
Ms store 下载 ubantu , 
然后 starten

![](image/Pasted%20image%2020240207153113.png)

----

2 
然后就可以找到 ubuntu shell 
![](image/Pasted%20image%2020240207153123.png)

----

3 给出 unix username  und password 

![](image/Pasted%20image%2020240207153251.png)

ivu 的电脑
我的 unix username : yzh
Password: 910613

![](image/Pasted%20image%2020240207153303.png)


## 3.2 后续操作 

4 Docker integration mit 新安装的 linux distribution 检查

![](image/Pasted%20image%2020240207153318.png)
上面说明 docker integration 还有没有 正确激活

----


5  Enable integration with weitere distribution 
![](image/Pasted%20image%2020240207153326.png)
![](image/Pasted%20image%2020240207153332.png)



如果出现下面的 error 信息
![](image/Pasted%20image%2020240207153410.png)

Es wird atomatisch in die Standard wsl distribution , die Docker intergration aktivieren
Dort (wsl distrobution ) wird autoamtisch ein Linux Docker sei eingbaut und auf weitere Kommandozeilen tools und man kan auch dort auf die docker enginee zu greifen

也得到了这样的错误信息
![](image/Pasted%20image%2020240207153434.png)

====Error cuase:

被发现 没有 wsl2 distribution ,
1 因为之前已经 安装了 wsl2 distribution ， 但是 还没有 将 WSL 2 设置为 als Standardversion
2  自己安装了 的 distribution 为 wsl 1 的
![](image/Pasted%20image%2020240207153559.png)

=== 解决方法
1 wsl --set-default-version 2
 -> Alle Weiteren Linux Distributionen wied gleich als wsl -2 aktiviert ind installiert

2
如果 从 Ms store 新下载一个 Linux distribution, 又会自动以 wsl version2 来运行，
之前已经下载的 linux distirbutionen , 会自动以 wsl version1 来运行，, 这时候需要再手动调整一下 wsl 的version

见



----
6
新更新 ubuntu (新安装的 Linux distributionen ) 的状态
使得他 能够使别  docker integration

hash -r  
-> die gefundenen programme im pfad zu aktualisieren 

![](image/Pasted%20image%2020240207153638.png)

![](image/Pasted%20image%2020240207153642.png)


----

7 

使用 wsl -l -v 查看 wsl 中是否能够查看 docker 
进而知道 wsl 中是否能够使用 docker 的命令 

![](image/Pasted%20image%2020240207153759.png)

Docker-decktop: enthalten Docker engine 
Docker-desktop-data: enthalten nur links und daten , wo mit die engine spater austauschen 

----

8 
Windows 中的 wsl2 ， docker Desktop dashboard 中也没有像 linux 中 docker Desktop dashboard  中 有 einstellung fur Grosse der Festplatte und mernge der Arbeitsspeicher von linux verbraucht 

因为 Zwei mechanismen von windows automatisch gehandelt. 


## 3.3 新的 Wsl 2 Linux Kernel  的安装后 , 如何更新 

https://docs.microsoft.com/de-de/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package

然后 restart docker , then wsl wird ausgepackt und Dienst gestartet 
![](image/Pasted%20image%2020240207153959.png)

![](image/Pasted%20image%2020240207154007.png)

![](image/Pasted%20image%2020240207154011.png)





